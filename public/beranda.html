<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Beranda - Sistem Pendaftaran Seminar</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen">
  <!-- Header -->
  <header class="bg-blue-600 text-white shadow-lg">
    <div class="container mx-auto px-4 py-6">
      <div class="flex justify-between items-center">
        <h1 class="text-2xl font-bold">Sistem Pendaftaran Seminar</h1>
        <nav class="flex space-x-4" id="navbar">
          <a href="/" class="hover:text-blue-200 transition">Beranda</a>
          <a href="/login.html" class="hover:text-blue-200 transition" id="loginLink">Login</a>
          <a href="/register.html" class="hover:text-blue-200 transition" id="registerLink">Register</a>
        </nav>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="container mx-auto px-4 py-8">
    <!-- Hero Section -->
    <section class="bg-white rounded-lg shadow-md p-8 mb-8">
      <div class="text-center">
        <h2 class="text-3xl font-bold text-gray-800 mb-4">Selamat Datang di Portal Seminar</h2>
        <p class="text-gray-600 text-lg mb-6">
          Platform terpercaya untuk mendaftar dan mengikuti berbagai seminar dan workshop berkualitas
        </p>
        <div class="flex justify-center space-x-4">
          <button onclick="checkAuthAndRedirect()" 
                  class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-semibold transition">
            Daftar Seminar
          </button>
          <a href="#info" class="bg-gray-200 hover:bg-gray-300 text-gray-800 px-6 py-3 rounded-lg font-semibold transition">
            Lihat Info
          </a>
        </div>
      </div>
    </section>

    <!-- Features Section -->
    <section id="info" class="grid md:grid-cols-3 gap-6 mb-8">
      <div class="bg-white p-6 rounded-lg shadow-md">
        <div class="text-blue-600 text-3xl mb-4">📚</div>
        <h3 class="text-xl font-semibold mb-2">Seminar Berkualitas</h3>
        <p class="text-gray-600">Menghadirkan seminar dengan pembicara berpengalaman dan materi terkini</p>
      </div>
      
      <div class="bg-white p-6 rounded-lg shadow-md">
        <div class="text-blue-600 text-3xl mb-4">🎓</div>
        <h3 class="text-xl font-semibold mb-2">Sertifikat Resmi</h3>
        <p class="text-gray-600">Dapatkan sertifikat resmi setelah menyelesaikan seminar</p>
      </div>
      
      <div class="bg-white p-6 rounded-lg shadow-md">
        <div class="text-blue-600 text-3xl mb-4">💻</div>
        <h3 class="text-xl font-semibold mb-2">Platform Digital</h3>
        <p class="text-gray-600">Sistem pendaftaran online yang mudah dan cepat</p>
      </div>
    </section>

    <!-- Call to Action -->
    <section class="bg-blue-50 rounded-lg p-8 text-center">
      <h3 class="text-2xl font-bold text-gray-800 mb-4">Siap Bergabung?</h3>
      <p class="text-gray-600 mb-6">
        Login terlebih dahulu untuk mengakses fitur pendaftaran seminar dan mengelola profil Anda
      </p>
      <div class="flex justify-center space-x-4">
        <a href="/login.html" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-semibold transition">
          Login Sekarang
        </a>
        <a href="/register.html" class="bg-white hover:bg-gray-50 text-blue-600 border border-blue-600 px-6 py-3 rounded-lg font-semibold transition">
          Daftar Akun
        </a>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="bg-gray-800 text-white py-6 mt-12">
    <div class="container mx-auto px-4 text-center">
      <p>&copy; 2025 Sistem Pendaftaran Seminar. Semua hak dilindungi.</p>
    </div>
  </footer>

  <script>
    // Cek status login saat halaman dimuat
    window.addEventListener('load', checkLoginStatus);

    function checkLoginStatus() {
      fetch('/check-auth', {
        method: 'GET',
        credentials: 'include'
      })
      .then(response => {
        if (response.ok) {
          return response.json();
        }
        throw new Error('Not logged in');
      })
      .then(data => {
        // User sudah login, update navbar
        updateNavbarForLoggedInUser(data.user);
      })
      .catch(() => {
        // User belum login, navbar tetap default
      });
    }

    function updateNavbarForLoggedInUser(user) {
      const navbar = document.getElementById('navbar');
      navbar.innerHTML = `
        <a href="/" class="hover:text-blue-200 transition">Beranda</a>
        <a href="/dashboard.html" class="hover:text-blue-200 transition">Dashboard</a>
        <span class="text-blue-200">Halo, ${user.name}</span>
        <button onclick="logout()" class="hover:text-blue-200 transition">Logout</button>
      `;
    }

    function logout() {
      if (confirm('Apakah Anda yakin ingin logout?')) {
        fetch('/logout', {
          method: 'POST',
          credentials: 'include'
        }).then(() => {
          window.location.reload();
        });
      }
    }

    // Fungsi untuk mengecek autentikasi dan mengarahkan ke halaman daftar
    function checkAuthAndRedirect() {
      // Cek apakah user sudah login dengan mencoba mengakses endpoint yang memerlukan auth
      fetch('/check-auth', {
        method: 'GET',
        credentials: 'include'
      })
      .then(response => {
        if (response.ok) {
          // User sudah login, redirect ke halaman daftar
          window.location.href = '/daftar';
        } else {
          // User belum login, tampilkan alert
          alert('⚠️ Silakan login terlebih dahulu untuk mendaftar seminar!\n\nAnda akan diarahkan ke halaman login.');
          window.location.href = '/login.html';
        }
      })
      .catch(error => {
        console.error('Error:', error);
        alert('⚠️ Silakan login terlebih dahulu untuk mendaftar seminar!\n\nAnda akan diarahkan ke halaman login.');
        window.location.href = '/login.html';
      });
    }

    // Smooth scrolling untuk anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
          });
        }
      });
    });
  </script>
</body>
</html>
